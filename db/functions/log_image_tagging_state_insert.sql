-- ActionFlag: 1 = insert, 2 = update, 3 = delete
CREATE OR REPLACE FUNCTION log_image_tagging_state_insert()
    RETURNS trigger AS
    '
        BEGIN
            INSERT INTO Image_Tagging_State_Audit(ImageId,TagStateId,ModifiedByUser,ModifiedDtim,ArchiveDtim,ActionFlag)
            VALUES(NEW.ImageId,NEW.TagStateId,NEW.ModifiedByUser,NEW.ModifiedDtim,current_timestamp,1);
            
            RETURN NEW;
        END;
    '
    LANGUAGE plpgsql; 